<html>
<head>
    <title>Restaurant Gateway Form</title>
    <style>
        img.background {
            width: 100%;
            height: 100%;
            position: absolute;
            left: 0px;
            top: 0px;
            z-index: -1;
            filter: blur(35px);
        }

        .for1{
            padding-left: 140px;
            padding-right: 0px;
            padding-top: 150px;
            padding-bottom: 0px;
            color:yellow;
        }

.dropbtn {
    background-color: rgb(0, 205, 212);
    color: rgb(43, 39, 39);
    padding: 15px;
    font-size: 18px;
    border: none;
    border-collapse: false;
}

.dropdown {
    position: center;
    display: inline-block;
}

.dropdown-content {
    display: none;
    position: center;
    background-color: #b1cab286;
    min-width: 200px;
    box-shadow: 0px 8px 16px 0px rgba(190, 49, 49, 0.2);
    z-index: 1;
}

.dropdown-content a {
    color: black;
    background-color: blue;
    padding: 12px 16px;
    text-decoration: none;
    display: block;
}
 .dropdown{
    padding-top: 50px;
    padding-right: 30px;
    padding-bottom: 50px;
    padding-left: 120px;
}

 .dropdown{
    padding-top: 50px;
    padding-right: 130px;
    padding-bottom: 50px;
    padding-left: 120px;
}

.dropdown-content a:hover {background-color: rgb(101, 235, 12);}
.dropdown:hover .dropdown-content {display: block;}
.dropdown:hover .dropbtn {background-color: #2bbe30;}

.dropbtn{
    color: black;
}
table, td {
    border: 0px solid rgb(231, 210, 14);
    color: yellow;
    text-align: center;
    vertical-align: center;
    padding: 1px;
    font-size: 21;
}
</style>
</head>

<body>
    <img class="background" src="rest1.jpg" alt="rest1" width="300" height="300">
    <h2 id="dimo3" hidden></h2>
    <h2 id="test"></h2>
    <h2 id="gim"></h2>
    <table align='center'  border='0' width='950px' cellpadding='2px' cellspacing='0' >
            <center><tr>
                
               <td>
                    <h1 align="center" style="color: rgb(43, 13, 8); font-size: 250%; font-family: 'Times New Roman', Times, serif"> RESTAURANT FOOD INFO </h1></td>
            </tr><center>
             <tr> <td>&nbsp;</td> </tr>
            <table  border='0' width='400' cellpadding='0' cellspacing='2px' align='left'>
            <tr>
                <td>       
                                 <div class="dropdown">
                            <button  class="dropbtn">Restaurants Name</button>
                            <div class="dropdown-content">
                                    <p id="restNames">
                                    </p> 
                            </div>
                        </div>
                    </td>

            </tr>
            </table>
        </table>
    <!-- <center> -->
 
    <script>
            function select_one(sels){
                if (sels=="solid"){
                    // alert(sel);
                    return "Solid"
                }
                else if (sels == "liquid")
                {
                    // alert(sel);
                    return "Liquid"
                }
            }
            
            function delete_entry(){
                // alert(document.getElementById("del_box").value);
                var tabl = document.getElementById("food_table");
                var indices  = [];
                for( a = 1; a< tabl.rows.length; a++){
                    
                    if (document.getElementById(tabl.rows[a].cells[1].innerHTML).checked == true){
                        indices.push(a);
                    }
                }
                indices.sort(function(a, b){return b-a});
                console.log(document.getElementById("food_list"));
                for(b=0; b< indices.length; b++){
                var x = document.getElementById("food_list");
                var option = document.createElement("option");
                option.text = tabl.rows[indices[b]].cells[1].innerHTML;
                option.value = tabl.rows[indices[b]].cells[1].innerHTML;
                x.add(option);
                        // alert(x);
                tabl.deleteRow(indices[b]);
                }    
                }       
    
            
            // function remove_one(sele){
            //    var list = document.getElementById("food_list");
            //    list.remove(list.selectedIndex);
            // }

            function send_cont_info(){
                form_window = window.open("","","width=500,height=500,scrollbars=1,resizable=1");
                form_window.document.write("<html><style>body{ background:green}</style>\
                <head><title>Contact Information Form</title><body>");
                form_window.document.write("<script>function send_con_info(){\
                    var con_data = {rest_name: document.getElementById(\"reta_name\").innerHTML,\
                     contactPerson: document.getElementById(\"cont_person\").value,\
                contactNumber: document.getElementById(\"con_number\").value,\
                pickupTime: document.getElementById(\"pick_time\").value,\
                pickupLocation: document.getElementById(\"location\").value,\
                packing: document.getElementById(\"package\").value};\
                console.log(con_data);\
                alert(\" Contact Information sent successfully! \");\
                var newJSON = \"\";\
                newJSON = JSON.stringify(con_data);\
                console.log(newJSON);\
                var xhttp_request = new XMLHttpRequest(); xhttp_request.onreadystatechange = function()\
                {\
                    if(this.readyState == 4 && this.status == 200){\
                   }};\
                xhttp_request.open(\"POST\", \"http://kbarman2l:8080/RegistrationAPI/webapi/Pickup\", true);\
                xhttp_request.setRequestHeader(\"Content-type\",\"application/json\");\
                xhttp_request.send(newJSON);\
                self.close();}<\/script><center>");

                form_window.document.write("<h1>Contact Information Form</h1>");
                form_window.document.write("<h2> Your Restaurant Name </h2><h2 id=\"reta_name\">" +
                document.getElementById("ret_name").innerHTML + "</h2>");
                form_window.document.write("<br><br><b>Contact Person: "+ "</b><input id = \"cont_person\" type=\"text\" name=\"cont_person\"></br></br>\
                <br><br><b>Contact Number: "+ "</b><input id = \"con_number\" type=\"text\"  name=\"con_number\" size=\"10\" maxlength=\"10\"></br></br>\
                <br><br><b>Picking Time: "+ "</b><input id = \"pick_time\" type=\"text\" name=\"pick_name\"></br></br>\
                <br><br><b>Location: "+ "</b><input id = \"location\" type=\"text\" name=\"location\"></br></br>\
                <br><br><b>Packaging: "+ "</b><input id = \"package\" type=\"text\" name=\"package\"></br></br>\
                <br><input type=\"button\" id=\"hy_button\" onclick=\"send_con_info()\" style=\"font-size: 18\" value=\"Send Info\"/><br><br>\
                </center></body></head>\
                </html>");
            }

            
            function add_food_info(){
                var rest_food_data = {"rest_name": document.getElementById("ret_name").innerHTML,
                "name": document.getElementById("food_list").value, "quantity":document.getElementById("quantity").value,
                "validity":document.getElementById("time").value, "type": document.getElementById("type_select").value};
                // if (rest_food_data.name){
                    // console.log("Hello World!");
                // }
                var variable_table = document.getElementById("food_table");
                var row = variable_table.insertRow();
                var cell1 = row.insertCell(0);
                var cell2 = row.insertCell(1);
                var cell3 = row.insertCell(2);
                var cell4 = row.insertCell(3);
                var cell5 = row.insertCell(4);
                cell1.innerHTML = rest_food_data.type;
                cell2.innerHTML = rest_food_data.name;
                cell3.innerHTML = rest_food_data.quantity;
                cell4.innerHTML = rest_food_data.validity;
                cell5.innerHTML = "<input type=\"checkbox\" name=\"tick\" id=\"" + 
                rest_food_data.name + "\" value=" + "\"" + rest_food_data.name + "\">";
                // document.getElementById("test").innerHTML = rest_food_data.name; 
                // console.log(cell1.innerHTML); 
                // console.log(cell3.innerHTML) ;
                // alert(" Food items added! ");
                // var nim = "Vibhu";
               var list = document.getElementById("food_list");
               list.remove(list.selectedIndex);
            
            }

            function send_food_info(food_reqs){

                var num_of_rows = document.getElementById("food_table").rows.length;
                // document.getElementById("test").innerHTML = document.getElementById("food_table").rows[0].cells[0].innerHTML;
                
                var my_object = [];
                // document.getElementById("test").innerHTML = my_object[0];
                for(i=1; i<num_of_rows;i++)
                {
                    var single_food_data = {"rest_name": document.getElementById("ret_name").innerHTML,
                    "type": document.getElementById("food_table").rows[i].cells[0].innerHTML,
                    "name": document.getElementById("food_table").rows[i].cells[1].innerHTML,
                    "quantity": document.getElementById("food_table").rows[i].cells[2].innerHTML,
                    "validity": document.getElementById("food_table").rows[i].cells[3].innerHTML};
                    console.log(single_food_data);
                    my_object[i-1] = single_food_data;
                }
                // document.getElementById("test").innerHTML = document.getElementById("food_table").rows[i].cells[1].innerHTML;
                var myJSON = JSON.stringify(my_object);
                // document.getElementById("test").innerHTML = my_object[0]["rest_name"];
               


                var xhttp_request1 = new XMLHttpRequest();
                xhttp_request1.onreadystatechange = function(){
                    console.log(this.status);
                      if(this.readyState == 4 && this.status == 200){
                        //  document.getElementById("dimo").innerHTML = 2;
                    }
                    };
                                    // document.getElementById("test").innerHTML = my_object[0]["rest_name"];

                xhttp_request1.open("POST", "http://kbarman2l:8080/RegistrationAPI/webapi/Publish", true);
                xhttp_request1.setRequestHeader("Content-type","application/json");
                xhttp_request1.send(myJSON);
                // alert(" Request Sent to Server ");
                var but_display = document.getElementById("send_button");
                form_window = window.open("","","width=500,height=500,scrollbars=1,resizable=1");
                form_window.document.write("<html><style>body{ background:white}</style>\
                <head><title>Contact Information Form</title><body>");
                form_window.document.write("<script>function send_con_info(){\
                    var con_data = {rest_name: document.getElementById(\"reta_name\").innerHTML,\
                     contactPerson: document.getElementById(\"cont_person\").value,\
                contactNumber: document.getElementById(\"con_number\").value,\
                pickupTime: document.getElementById(\"pick_time\").value,\
                pickupLocation: document.getElementById(\"location\").value,\
                packing: document.getElementById(\"package\").value};\
                console.log(con_data);\
                var newJSON = \"\";\
                newJSON = JSON.stringify(con_data);\
                console.log(newJSON);\
                var xhttp_request = new XMLHttpRequest(); xhttp_request.onreadystatechange = function()\
                {\
                    if(this.readyState == 4 && this.status == 200){\
                   }};\
                xhttp_request.open(\"POST\", \"http://kbarman2l:8080/RegistrationAPI/webapi/Pickup\", true);\
                xhttp_request.setRequestHeader(\"Content-type\",\"application/json\");\
                xhttp_request.send(newJSON);\
                alert(\" Contact Information sent successfully! \");\
                document.open();\
                document.write(\"<h1><center> We shall work together!</center></h1>\");}\
                <\/script>");
                
                form_window.document.write("<h1>Contact Information Form</h1>");
                form_window.document.write("<h2> Your Restaurant Name </h2><h2 id=\"reta_name\">" +
                document.getElementById("ret_name").innerHTML + "</h2>");
                form_window.document.write("<br><br><b>Contact Person: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\
                    &nbsp;&nbsp;&nbsp;"+ "</b><input id = \"cont_person\" type=\"text\" name=\"cont_person\"></br></br>\
                <br><br><b>Contact Number: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\
                    "+ "</b><input id = \"con_number\" type=\"text\"  name=\"con_number\" size=\"10\" maxlength=\"10\"></br></br>\
                <br><br><b>Picking Time: &nbsp;&nbsp;&nbsp;\
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+ "</b><input id =\
                     \"pick_time\" type=\"time\" name=\"pick_name\"></br></br>\
                <br><br><b>Location: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+ "</b><input id = \"location\" type=\"text\" name=\"location\"></br></br>\
                <br><br><b>Packaging: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+ "</b><input id = \"package\" type=\"text\" name=\"package\"></br></br>\
                <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\
                <input type=\"button\" id=\"hy_button\" onclick=\"send_con_info()\" \
                style=\"font-size: 18\" value=\"Send Info\"/><br><br>\
                </body></head>\
                </html>");
                
            }

            function new_form(argu){
                // alert("Sure! Your restaurant is " + argu);
                
                document.getElementById("dimo").innerHTML = "<h1><font color=\"white\">"
                 + "<p id=\"ret_name\">" + argu +"</p>"+ "</font></h1>";
                var hotel_specific_menu  = document.getElementById( document.getElementById("ret_name").innerHTML).innerHTML.split(",");
                var num_of_food_items = hotel_specific_menu.length;
                // alert(num_of_food_items);
                  
                document.getElementById("dimo").innerHTML += "&nbsp;<b><font color=\"yellow\">Food type: </font></b>\
                <select id=\"type_select\" onchange=\
                \"select_one(this.value)\">\
                <option value=\"\">Choose Food type:</option>\
                <option value=\"Solid\">Solid</option>\
                <option value=\"Liquid\">Liquid</option></select>";

                document.getElementById("dimo").innerHTML += "&nbsp;<b><font color=\"yellow\">Food Name:</font></b>\
                <select id=\"food_list\" onchange=remove_one(this.value)></select>";

                var x = "";
                var option = "";
                x = document.getElementById("food_list");
                option = document.createElement("option");
                option.text = "Choose the food: ";
                option.value = "";
                x.add(option);
                for(k = 0; k<num_of_food_items; k++){
                     x = document.getElementById("food_list");
                    option = document.createElement("option");
                    option.text = hotel_specific_menu[k];
                    option.value = hotel_specific_menu[k];
                    x.add(option);
                }


                document.getElementById("dimo").innerHTML += "&nbsp;<b><font color=\"yellow\">Quantity: "+
                 "</font></b>\
                <input id = \"quantity\" type=\"number\" name=\"quantity\" min=\"0\">";
                
                document.getElementById("dimo").innerHTML += "&nbsp;<b><font color=\"yellow\">Duration to collect (hrs):\
                 </font></b>\
                <input id=\"time\" type=\"number\" name=\"time\" min=\"0\">";

                document.getElementById("dimo").innerHTML += "<br><br><input type=\"button\" \
                onclick=\"add_food_info()\" style=\"font-size: 18\" value=\"Add food info\"/>"
                
                document.getElementById("dimo").innerHTML += "&nbsp;<input type=\"button\" \
                onclick=\"send_food_info()\" style=\"font-size: 18\" value=\"Send food info\"/>"
                
                document.getElementById("dimo").innerHTML += "&nbsp;<input type=\"button\" \
                onclick=\"delete_entry()\" style=\"font-size: 18\" value=\"Delete entry\"/>"
                
                // document.getElementById("dimo").innerHTML += "&nbsp;<input id=\"send_button\" type=\"button\" \
                // onclick=\"send_cont_info()\" style=\"font-size: 18\" value=\"Send contact info\"/>"

                document.getElementById("dimo").innerHTML += "<center><br><br><br><br>\
                <table width=800 id= \"food_table\">\
                <tr><td><b style=\"color:yellow\" \
                >Food Type</b></td><td><b style=\"color:yellow\">Food Name</b></td><td><b style=\"color:yellow\">Quantity</b>\
                </td><td><b style=\"color:yellow\">Duration to Collect (hours)</b></td><td><b>Select to delete</b></td>\
                </tr></table></font></center>"
            
              }
        var xhttp_request = new XMLHttpRequest();
        xhttp_request.onreadystatechange = function get_elements(){
            if(this.readyState == 4 && this.status == 200) {
                rest_infos = JSON.parse(this.responseText);
            document.getElementById('restNames').innerHTML = " ";
            var length = rest_infos.length;
            // var rest_food_menus = {};
            // rest_food_menus["hello"] = "world";
            for(i=0; i< length;i++)
            {
                document.getElementById('restNames').innerHTML += "<br><option onclick=\"new_form(this.value)\"" +"value=" + 
                "\""+rest_infos[i].name+"\"" + ">" + rest_infos[i].name + "</option><br>";
                // rest_food_menus[rest_infos[i].name] = rest_infos[i].foodMenu;
                // alert(typeof rest_infos[i].name);
                // alert(rest_infos[i].name);
                document.getElementById("dimo3").innerHTML += "<p id=\"" + rest_infos[i].name + "\"/>"+ rest_infos[i].foodMenu
                +"</p>";
            }
            }             
        };
           
        xhttp_request.open("GET", "http://kbarman2l:8080/RegistrationAPI/webapi/Restaurant/Info", true);
        xhttp_request.send();
        </script>
        <p id="dimo"> </p>
        <!-- <p id="dimo3"></p> -->
</body>

</html>